{
  "dashboard": {
    "title": "Tick Ingestion Service",
    "tags": ["tick-ingester", "continuum", "timescaledb"],
    "timezone": "browser",
    "panels": [
      {
        "title": "Ticks Ingested (Rate)",
        "type": "graph",
        "targets": [
          {
            "expr": "rate(tick_ingester_ticks_total{status=\"success\"}[1m])",
            "legendFormat": "Success"
          },
          {
            "expr": "rate(tick_ingester_ticks_total{status=\"error\"}[1m])",
            "legendFormat": "Error"
          }
        ],
        "yaxes": [
          {
            "label": "Ticks/sec",
            "format": "short"
          }
        ]
      },
      {
        "title": "Buffer Utilization",
        "type": "graph",
        "targets": [
          {
            "expr": "tick_ingester_buffer_size",
            "legendFormat": "Buffer Size"
          }
        ],
        "yaxes": [
          {
            "label": "Ticks",
            "format": "short"
          }
        ]
      },
      {
        "title": "Write Latency (p50, p95, p99)",
        "type": "graph",
        "targets": [
          {
            "expr": "histogram_quantile(0.50, rate(tick_ingester_write_duration_seconds_bucket[5m]))",
            "legendFormat": "p50"
          },
          {
            "expr": "histogram_quantile(0.95, rate(tick_ingester_write_duration_seconds_bucket[5m]))",
            "legendFormat": "p95"
          },
          {
            "expr": "histogram_quantile(0.99, rate(tick_ingester_write_duration_seconds_bucket[5m]))",
            "legendFormat": "p99"
          }
        ],
        "yaxes": [
          {
            "label": "Seconds",
            "format": "s"
          }
        ]
      },
      {
        "title": "Batch Size Distribution",
        "type": "graph",
        "targets": [
          {
            "expr": "histogram_quantile(0.50, rate(tick_ingester_batch_size_bucket[5m]))",
            "legendFormat": "p50"
          },
          {
            "expr": "histogram_quantile(0.95, rate(tick_ingester_batch_size_bucket[5m]))",
            "legendFormat": "p95"
          }
        ],
        "yaxes": [
          {
            "label": "Ticks/batch",
            "format": "short"
          }
        ]
      },
      {
        "title": "Error Rates",
        "type": "graph",
        "targets": [
          {
            "expr": "rate(tick_ingester_parse_errors_total[1m])",
            "legendFormat": "Parse Errors"
          },
          {
            "expr": "rate(tick_ingester_write_errors_total[1m])",
            "legendFormat": "Write Errors"
          }
        ],
        "yaxes": [
          {
            "label": "Errors/sec",
            "format": "short"
          }
        ]
      },
      {
        "title": "Stream Reconnections",
        "type": "graph",
        "targets": [
          {
            "expr": "rate(tick_ingester_stream_reconnects_total[5m])",
            "legendFormat": "Reconnects"
          }
        ],
        "yaxes": [
          {
            "label": "Reconnects/sec",
            "format": "short"
          }
        ]
      }
    ]
  }
}
